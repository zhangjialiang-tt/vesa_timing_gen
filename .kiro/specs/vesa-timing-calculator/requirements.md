# 需求文档

## 简介

VESA 视频时序计算器是一个桌面 GUI 应用程序，用于根据 VESA CVT (Coordinated Video Timing) 标准计算视频时序参数。该工具面向显示器工程师、硬件开发人员和技术人员，帮助他们快速准确地计算标准和节能模式下的视频时序参数。

## 术语表

- **应用程序 (Application)**: VESA 视频时序计算器桌面应用
- **CVT**: Coordinated Video Timing，VESA 协调视频时序标准
- **CVT-RB**: CVT Reduced Blanking，CVT 缩减消隐模式
- **水平有效像素 (H. Active Pixels)**: 显示器每行的有效像素数量
- **垂直有效行数 (V. Active Lines)**: 显示器每帧的有效行数
- **刷新率 (Refresh Rate)**: 显示器每秒刷新画面的次数，单位为 Hz
- **像素时钟 (Pixel Clock)**: 像素传输速率，单位为 MHz
- **消隐区 (Blanking)**: 视频信号中不显示图像的时间段
- **前廊 (Front Porch)**: 有效显示区域结束到同步脉冲开始之间的时间
- **同步脉冲 (Sync Pulse)**: 用于同步显示器扫描的信号
- **后廊 (Back Porch)**: 同步脉冲结束到下一个有效显示区域开始之间的时间

## 需求

### 需求 1

**用户故事:** 作为显示器工程师，我希望能够输入基本的显示参数，以便快速获取符合 VESA CVT 标准的时序计算结果。

#### 验收标准

1. WHEN 用户输入水平分辨率、垂直分辨率和刷新率 THEN 应用程序 SHALL 接受这些输入值并存储以供计算使用
2. WHEN 用户输入的水平分辨率值 THEN 应用程序 SHALL 限制输入范围在 640 到 7680 像素之间
3. WHEN 用户输入的垂直分辨率值 THEN 应用程序 SHALL 限制输入范围在 480 到 4320 行之间
4. WHEN 用户输入的刷新率值 THEN 应用程序 SHALL 限制输入范围在 24 到 240 Hz 之间
5. WHEN 用户勾选或取消勾选 "Reduced Blanking" 复选框 THEN 应用程序 SHALL 记录该选项状态以用于计算模式选择

### 需求 2

**用户故事:** 作为硬件开发人员，我希望应用程序能够根据 VESA CVT 标准精确计算所有时序参数，以便我能够正确配置显示控制器。

#### 验收标准

1. WHEN 用户提供有效的输入参数 THEN 应用程序 SHALL 使用 VESA CVT 标准算法计算像素时钟
2. WHEN 用户提供有效的输入参数 THEN 应用程序 SHALL 计算水平总像素、水平消隐区、水平前廊、水平同步脉冲和水平后廊
3. WHEN 用户提供有效的输入参数 THEN 应用程序 SHALL 计算垂直总行数、垂直消隐区、垂直前廊、垂直同步脉冲和垂直后廊
4. WHEN "Reduced Blanking" 选项被启用 THEN 应用程序 SHALL 使用 CVT-RB 算法进行计算以减少消隐时间
5. WHEN "Reduced Blanking" 选项被禁用 THEN 应用程序 SHALL 使用标准 CVT 算法进行计算
6. WHEN 计算完成 THEN 应用程序 SHALL 确保所有输出参数的数值精度至少保留两位小数

### 需求 3

**用户故事:** 作为用户，我希望能够实时看到计算结果，以便快速验证不同参数组合的效果。

#### 验收标准

1. WHEN 用户修改任何输入参数 THEN 应用程序 SHALL 在 500 毫秒内自动重新计算并更新显示结果
2. WHEN 用户点击"计算"按钮 THEN 应用程序 SHALL 立即执行计算并更新显示结果
3. WHEN 计算结果更新 THEN 应用程序 SHALL 在输出区域清晰显示所有 11 个时序参数及其单位
4. WHEN 输入参数无效（如为零或超出范围）THEN 应用程序 SHALL 清空结果区域并显示错误提示信息

### 需求 4

**用户故事:** 作为技术人员，我希望能够快速选择常见的分辨率预设，以便节省手动输入的时间。

#### 验收标准

1. WHEN 用户打开预设下拉菜单 THEN 应用程序 SHALL 显示至少 5 个常见分辨率预设选项
2. WHEN 用户从下拉菜单选择一个预设 THEN 应用程序 SHALL 自动填充对应的水平分辨率、垂直分辨率和刷新率到输入框
3. WHEN 预设被选择并填充 THEN 应用程序 SHALL 自动触发计算并显示结果
4. WHERE 预设选项存在 THEN 应用程序 SHALL 包含以下预设：1280x720@60Hz、1920x1080@60Hz、2560x1440@60Hz、3840x2160@60Hz、1920x1200@60Hz

### 需求 5

**用户故事:** 作为用户，我希望能够方便地复制计算结果，以便将数据用于文档或其他工具。

#### 验收标准

1. WHEN 用户点击"复制所有结果"按钮 THEN 应用程序 SHALL 将所有计算结果格式化为文本并复制到系统剪贴板
2. WHEN 结果被复制到剪贴板 THEN 应用程序 SHALL 使用清晰的格式，每个参数占一行，包含参数名称、数值和单位
3. WHEN 复制操作成功 THEN 应用程序 SHALL 显示一个简短的确认提示（如状态栏消息或临时提示）
4. WHEN 没有计算结果时用户点击复制按钮 THEN 应用程序 SHALL 显示提示信息告知用户没有可复制的内容

### 需求 6

**用户故事:** 作为用户，我希望应用程序具有清晰专业的界面布局，以便我能够高效地使用该工具。

#### 验收标准

1. WHEN 应用程序启动 THEN 应用程序 SHALL 显示一个主窗口，左侧为输入区域，右侧为输出区域
2. WHEN 主窗口显示 THEN 应用程序 SHALL 使用 QGroupBox 组织输入控件，标题为"输入参数"
3. WHEN 主窗口显示 THEN 应用程序 SHALL 使用 QGroupBox 组织输出控件，标题为"计算结果"
4. WHEN 输出结果显示 THEN 应用程序 SHALL 使用 QTableWidget 以两列形式展示，第一列为参数名称，第二列为数值和单位
5. WHEN 用户调整窗口大小 THEN 应用程序 SHALL 保持布局合理，输出表格能够自适应调整

### 需求 7

**用户故事:** 作为开发人员，我希望代码结构清晰且易于维护，以便未来能够轻松扩展功能或修复问题。

#### 验收标准

1. WHEN 代码被组织 THEN 应用程序 SHALL 将 CVT 计算逻辑封装在独立的 VesaCalculator 类中
2. WHEN 代码被组织 THEN 应用程序 SHALL 将所有 UI 逻辑封装在独立的 MainWindow 类中
3. WHEN VesaCalculator 类被调用 THEN 应用程序 SHALL 通过 calculate 方法接收输入参数并返回包含所有结果的字典
4. WHEN 代码被审查 THEN 应用程序 SHALL 包含清晰的注释，特别是 CVT 算法的关键步骤
5. WHEN 代码被审查 THEN 应用程序 SHALL 遵循 PEP 8 命名规范和代码风格

### 需求 8

**用户故事:** 作为用户，我希望应用程序能够妥善处理错误情况，以便在输入无效时获得清晰的反馈。

#### 验收标准

1. WHEN 用户输入的分辨率或刷新率小于或等于零 THEN 应用程序 SHALL 清空结果区域并显示错误消息
2. WHEN 用户输入的参数超出允许范围 THEN 应用程序 SHALL 自动将值限制在有效范围内
3. WHEN 计算过程中发生异常 THEN 应用程序 SHALL 捕获异常并向用户显示友好的错误提示
4. WHEN 错误被显示 THEN 应用程序 SHALL 在状态栏或输出区域使用红色文本或警告图标突出显示错误信息
