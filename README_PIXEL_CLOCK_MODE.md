# VESA 时序计算器 - 像素时钟计算模式

## 功能说明

应用程序现在支持两种计算模式：

### 模式 1: 从刷新率计算像素时钟（正向计算）
- **输入参数**: 水平分辨率、垂直分辨率、刷新率
- **输出结果**: 像素时钟和所有时序参数
- **用途**: 设计新的显示时序，根据目标刷新率计算所需的像素时钟

### 模式 2: 从像素时钟计算刷新率（反向计算）
- **输入参数**: 水平分辨率、垂直分辨率、像素时钟
- **输出结果**: 刷新率和所有时序参数
- **用途**: 分析现有的显示时序，根据已知的像素时钟计算实际刷新率

## 使用方法

### 启动应用程序
```bash
python vesa_timing_calculator.py
```

### 切换计算模式
1. 在"计算模式"下拉菜单中选择：
   - "从刷新率计算像素时钟" - 正向计算
   - "从像素时钟计算刷新率" - 反向计算

2. 根据选择的模式，相应的输入框会自动启用/禁用：
   - 正向计算：刷新率输入框启用，像素时钟输入框禁用
   - 反向计算：像素时钟输入框启用，刷新率输入框禁用

### 输入参数
1. **水平分辨率**: 640-7680 像素
2. **垂直分辨率**: 480-4320 行
3. **刷新率** (正向计算): 24-240 Hz
4. **像素时钟** (反向计算): 10-1000 MHz
5. **Reduced Blanking**: 勾选以使用 CVT-RB 模式

### 实时计算
- 修改任何输入参数后，应用程序会自动重新计算
- 也可以点击"计算"按钮手动触发计算

## 应用场景

### 场景 1: 设计显示时序
**需求**: 为 1920x1080 显示器设计 60Hz 刷新率的时序

**操作**:
1. 选择"从刷新率计算像素时钟"模式
2. 输入: 1920x1080, 60Hz
3. 查看结果: 像素时钟约 147.84 MHz

### 场景 2: 分析现有时序
**需求**: 已知像素时钟为 148.5 MHz，计算实际刷新率

**操作**:
1. 选择"从像素时钟计算刷新率"模式
2. 输入: 1920x1080, 148.5 MHz
3. 查看结果: 刷新率约 60.21 Hz

### 场景 3: 验证 HDMI 标准时序
**需求**: 验证 HDMI 1080p60 标准时序 (148.5 MHz)

**操作**:
1. 选择"从像素时钟计算刷新率"模式
2. 输入: 1920x1080, 148.5 MHz
3. 验证计算出的刷新率是否接近 60 Hz

## 技术细节

### CVT 标准模式
- 使用 VESA CVT 1.2 标准算法
- 根据分辨率自动调整消隐参数
- 适用于模拟和数字显示接口

### CVT-RB 模式
- 使用固定的消隐参数减少带宽
- 水平消隐: 160 像素
- 垂直消隐时间: 460 微秒
- 适用于数字显示接口 (DVI, HDMI, DisplayPort)

### 反向计算算法
反向计算使用迭代方法：
1. 根据 CVT 标准确定固定的消隐参数
2. 计算水平和垂直总像素/行数
3. 使用公式计算刷新率: `refresh_rate = pixel_clock * 1,000,000 / (h_total * v_total)`
4. 迭代调整垂直消隐以满足 CVT 标准的时间要求

## 测试示例

### 标准 1080p60 (HDMI)
- 输入: 1920x1080, 148.5 MHz
- 输出: 60.21 Hz
- 水平总像素: 2200
- 垂直总行数: 1121

### CVT-RB 1080p60
- 输入: 1920x1080, 138.5 MHz, RB
- 输出: 59.93 Hz
- 水平总像素: 2080
- 垂直总行数: 1111

### 4K 显示
- 输入: 3840x2160, 297 MHz
- 输出: 32.66 Hz
- 水平总像素: 4128
- 垂直总行数: 2203

## 注意事项

1. **精度**: 由于 CVT 标准的舍入规则，反向计算的刷新率可能与原始值略有差异
2. **范围限制**: 像素时钟范围设置为 10-1000 MHz，覆盖大多数实际应用
3. **迭代收敛**: 反向计算使用最多 5 次迭代以确保满足 CVT 标准要求
4. **模式切换**: 切换计算模式时会自动触发重新计算

## 常见问题

**Q: 为什么反向计算的刷新率不是整数？**
A: CVT 标准使用固定的消隐参数和舍入规则，导致实际刷新率可能略有偏差。

**Q: 如何获得精确的 60Hz？**
A: 使用正向计算模式，输入 60Hz 刷新率，应用程序会计算出符合 CVT 标准的像素时钟。

**Q: CVT-RB 模式有什么优势？**
A: CVT-RB 使用更小的消隐区域，降低带宽需求，适合数字接口，可以支持更高的分辨率或刷新率。

## 技术支持

如有问题或建议，请参考 VESA CVT 1.2 标准文档。
